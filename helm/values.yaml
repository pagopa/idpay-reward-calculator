microservice-chart:
  namespace: "idpay"
  nameOverride: ""
  fullnameOverride: ""

  livenessProbe:
    httpGet:
      path: /actuator/health
      port: 8080
    initialDelaySeconds: 60
    failureThreshold: 6
    periodSeconds: 10

    readinessProbe:
      httpGet:
        path: /actuator/health
        port: 8080
      initialDelaySeconds: 60
      failureThreshold: 6
      periodSeconds: 10

    deployment:
      create: true

    service:
      create: true
      type: ClusterIP
      port: 8080

    ingress:
      create: true
      host: "dev01.idpay.internal.dev.cstar.pagopa.it"
      path: /idpay/reward/(.*)

    serviceAccount:
      create: false
      annotations: { }
      name: ""

    podAnnotations: { }

    podSecurityContext:
      seccompProfile:
        type: RuntimeDefault

    securityContext:
      allowPrivilegeEscalation: false

    envSecret:
      #    APPLICATIONINSIGHTS_CONNECTION_STRING: appinsights-instrumentation-key
      MONGODB_URI: mongodb-connection-string
      KAFKA_RTD_SASL_JAAJ_CONFIG: evh-rtd-trx-rtd-trx-consumer-jaas-config
      KAFKA_RTD_PROD_SASL_JAAJ_CONFIG: evh-rtd-trx-rtd-trx-producer-jaas-config
      KAFKA_REWARD_RESPONSE_SASL_JAAJ_CONFIG: evh-idpay-transaction-idpay-transaction-producer-jaas-config-idpay-01
      KAFKA_REWARD_RULE_REQUEST_SASL_JAAJ_CONFIG: evh-idpay-rule-update-idpay-rule-update-consumer-jaas-config-idpay-01
      KAFKA_TRANSACTION_USER_ID_SPLITTER_SASL_JAAJ_CONFIG: evh-idpay-transaction-user-id-splitter-idpay-transaction-user-id-splitter-consumer-jaas-config-idpay-01
      # TODO fix error topic reference
      KAFKA_ERRORS_SASL_JAAJ_CONFIG: evh-idpay-transaction-error-idpay-transaction-error-producer-jaas-config-idpay-01

    envConfig:
      MONGODB_DBNAME: idpay
      APPLICATIONINSIGHTS_ROLE_NAME: "idpaytimeline"
      APPLICATIONINSIGHTS_INSTRUMENTATION_LOGGING_LEVEL: "OFF"
      APPLICATIONINSIGHTS_INSTRUMENTATION_MICROMETER_ENABLED: "false"
      JAVA_TOOL_OPTIONS: -Xms128m -Xmx4g -javaagent:/app/applicationinsights-agent.jar
      # CACHE_REFRESH_MS_RATE: 31536000000 TODO to fill into configMap

    envConfigMapExternals:
      idpay-common:
        TZ: TZ
      idpay-eventhub-01:
        KAFKA_BROKER: kafka_broker
        KAFKA_REWARD_SASL_MECHANISM: kafka_sasl_mechanism
        KAFKA_REWARD_SECURITY_PROTOCOL: kafka_security_protocol
        KAFKA_TOPIC_TRANSACTION: idpay_transaction_topic
        # TODO fix error topic reference
        KAFKA_ERRORS_BROKER: kafka_broker
        KAFKA_ERRRORS_TOPIC: idpay_transaction_error_topic
      rtd-eventhub:
        KAFKA_RTD_BROKER: kafka_broker_rtd